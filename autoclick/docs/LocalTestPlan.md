> 📁 本文件遵循 docs/ENVIRONMENT_CONFIG.md 中的规范
> 📅 最後修改時間：2025-05-04 00:06

<!-- DO NOT MODIFY: This file defines critical rules for AI behavior, project architecture, and acceptance testing. -->

# AutoClicker for macOS - 本地测试计划

## 📋 概述
本文檔用於在 macOS 上本地測試 App 功能是否運作正常，檢查畫面顯示、按鈕操作、權限狀況、儲存行為與錯誤回饋是否符合規範。

## 🧪 測試項目一覽

### UI 測試
| 測試代碼 | 測試項目 | 操作步驟 | 預期結果 |
|---------|---------|---------|---------|
| UI-001 | 主畫面載入 | 執行 App 並進入主畫面 | 成功顯示 MainView，無錯誤，Canvas 可 Resume |
| UI-002 | 播放按鈕功能 | 點擊「▶️ 播放」 | 顯示播放中狀態或輸出 log |
| UI-003 | 錄製按鈕功能 | 點擊「⏺ 錄製」 | 開始記錄操作，或提示尚未授權 |
| UI-004 | 停止按鈕功能 | 錄製或播放中點「⏹ 停止」 | 成功終止並更新狀態 |
| UI-005 | 腳本列表顯示 | 建立一筆假腳本並 reload | ScriptListItemView 正確顯示名稱與次數 |
| UI-006 | 按下刪除按鈕 | 點擊腳本項目「🗑」 | 該腳本項目從列表移除 |
| UI-007 | 深色模式切換 | 切換系統深色模式 | 界面正確切換主題，無顯示異常 |
| UI-008 | 快捷鍵顯示 | 查看快捷鍵提示 | 顯示正確的快捷鍵組合 |
| UI-009 | 錯誤提示顯示 | 觸發錯誤操作 | 顯示友好的錯誤提示 |

### 🔐 權限驗收項目
| 測試代碼 | 權限類型 | 驗證方式 | 預期結果 |
|---------|---------|---------|---------|
| SEC-001 | 輔助使用權限 | 啟動 App 時無權限 → 是否彈提示 | 顯示 Console 提示並引導用戶打開系統設定 |
| SEC-002 | 螢幕錄製權限 | 使用 CGDisplayCreateImage 失敗 → 顯示 log 提示 | 顯示缺乏螢幕錄製權限的 Console 提示 |
| SEC-003 | 權限狀態監控 | 運行中移除權限 | 正確提示並暫停相關功能 |
| SEC-004 | 權限恢復處理 | 重新授予權限 | 功能自動恢復正常 |

### 💾 儲存與資料驗收
| 測試代碼 | 項目 | 操作步驟 | 預期結果 |
|---------|------|---------|---------|
| DATA-001 | 儲存腳本 | 錄製一筆腳本並儲存 | 檔案寫入到 Application Support/AutoClicker/ |
| DATA-002 | 讀取腳本 | 重啟 App → 顯示先前儲存腳本 | 項目正確出現在主畫面 |
| DATA-003 | 快捷鍵設定儲存 | 變更快捷鍵 → 關閉再開 App | 設定仍然有效，讀自 UserDefaults |
| DATA-004 | 圖像模板儲存 | 添加圖像模板 | 正確儲存到 images 目錄 |

### 🖼️ 圖像識別測試
| 測試代碼 | 項目 | 操作步驟 | 預期結果 |
|---------|------|---------|---------|
| IMG-001 | 圖像採集 | 截取目標區域 | 成功生成模板圖像 |
| IMG-002 | 識別準確度 | 執行圖像識別 | 識別準確率 > 95% |
| IMG-003 | 識別延遲 | 測量識別時間 | 延遲 < 100ms |
| IMG-004 | 多圖識別 | 設置多個模板 | 按順序正確識別 |

### 模組管理測試
| 測試代碼 | 項目 | 操作步驟 | 預期結果 |
|---------|------|---------|---------|
| MOD-001 | 模組生成 | 執行模組生成命令 | 成功生成新模組，符合規範 |
| MOD-002 | 模組擴充 | 執行模組擴充命令 | 成功擴充現有模組，保持兼容性 |
| MOD-003 | 模組合併 | 執行模組合併命令 | 成功合併多個模組，無衝突 |
| MOD-004 | 規範檢查 | 執行規範檢查命令 | 所有模組符合 STYLE_GUIDE.md 要求 |

## 🧰 整合測試建議

### 1. 圖像辨識測試
- 測試錄製中進行畫面圖像辨識是否會干擾
- 驗證辨識準確率
- 檢查辨識延遲
- 測試多圖像識別順序

### 2. 多腳本執行測試
- 測試同時運行 2 個以上 Script 是否間隔執行
- 驗證腳本執行順序
- 檢查資源使用情況
- 測試腳本暫停/恢復

### 3. 本地化測試
- 測試 SettingsView 變更語言是否即時更新
- 驗證所有 UI 元素是否正確翻譯
- 檢查 RTL 佈局支持
- 測試日期時間格式

### 4. 性能測試
- 測試內存使用情況
- 監控 CPU 佔用率
- 檢查響應時間
- 驗證電池影響

## 📝 測試記錄模板

### 測試環境
- macOS 版本：
- 設備型號：
- 測試時間：
- 測試人員：
- 測試環境：
  - 屏幕分辨率：
  - 系統語言：
  - 深色模式：

### 測試結果
| 測試代碼 | 結果 | 備註 |
|---------|------|------|
|         |      |      |

### 問題記錄
1. 發現問題：
2. 重現步驟：
3. 預期行為：
4. 實際行為：
5. 影響程度：
6. 解決方案：

### 性能數據
- 啟動時間：
- 內存佔用：
- CPU 使用率：
- 響應延遲：

## 🔄 更新日誌

### v1.0.0
- 初始測試計劃
- 定義基礎測試項目
- 建立測試模板
- 完善測試規範

### v1.1.0
- 增加圖像識別測試
- 添加性能測試項目
- 完善本地化測試
- 優化測試記錄 

## 單元測試
1. 圖像識別模塊
   - [ ] 模板匹配算法測試
   - [ ] 圖像預處理測試
   - [ ] 識別結果驗證測試
   - [ ] 異常處理測試

2. 點擊模塊
   - [ ] 座標計算測試
   - [ ] 點擊事件測試
   - [ ] 點擊序列測試
   - [ ] 錯誤處理測試

3. 快捷鍵模塊
   - [ ] 快捷鍵註冊測試
   - [ ] 快捷鍵響應測試
   - [ ] 快捷鍵衝突測試
   - [ ] 異常處理測試

## UI 測試
1. 主界面測試
   - [ ] 佈局測試
   - [ ] 交互測試
   - [ ] 響應性測試
   - [ ] 異常處理測試

2. 設置界面測試
   - [ ] 參數設置測試
   - [ ] 保存/讀取測試
   - [ ] 驗證測試
   - [ ] 錯誤提示測試

## 性能測試
1. 資源使用測試
   - [ ] CPU 使用率測試
   - [ ] 內存使用測試
   - [ ] 磁盤 I/O 測試
   - [ ] 網絡使用測試

2. 響應時間測試
   - [ ] 啟動時間測試
   - [ ] 識別時間測試
   - [ ] 點擊延遲測試
   - [ ] UI 響應測試

## 自動化校驗要求
- PR/CI 流程需自動校驗：
  - 測試覆蓋率
  - 測試執行時間
  - 測試穩定性
  - 測試報告生成
  - 主要文檔變更需自動生成變更日誌並通知團隊 